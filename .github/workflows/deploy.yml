name: DÃ©ploiement automatique (Compose)

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ§¾ RÃ©cupÃ©ration du code
        uses: actions/checkout@v4

      - name: ğŸ³ VÃ©rifier Docker et Compose
        run: |
          docker --version
          docker-compose version

      - name: ğŸš€ DÃ©ploiement avec Docker Compose (local ou distant)
        run: |
          echo "=== ğŸš§ DÃ©but du dÃ©ploiement avec Docker Compose ==="

          # Stopper les anciens conteneurs
          docker-compose down

          # Reconstruire et relancer tout le stack
          docker-compose up -d --build

          # Afficher les conteneurs actifs
          docker-compose ps

          echo "=== âœ… DÃ©ploiement terminÃ© ==="
